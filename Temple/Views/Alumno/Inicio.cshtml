
@{
    ViewBag.Title = "Inicio";
    Layout = "~/Views/Shared/_LayoutTemple.cshtml";
}

<h2>Recomendados para ti</h2>
@{
    const int cartasVisibles = 7;
    int contador = 0;

}
@foreach (var r in ViewBag.recomendados)
{
    <h2>@r.prefApr.desSub</h2>

    <div class="cycle-slideshow"
         data-cycle-fx="carousel"
         data-cycle-timeout=0
         data-cycle-carousel-visible=@cartasVisibles
         data-cycle-next="#next@(contador)"
         data-cycle-prev="#prev@(contador)"
         data-cycle-pager="#pager"
         data-cycle-slides="> div"
         data-allow-wrap="false">

        @foreach (var ci in r.instructores)
        {

            <div class="thumbnail carta">
                <img src="~/imagenes/mila.jpg" class="img-perfil-carta"
                     alt="...">
                <div class="caption">
                    <h4 class="text-center">@ci.nombres  @ci.apPaterno</h4>
                    <h5 class="text-center text-muted">@ci.especialidad</h5>
                    <h6 class="text-center text-muted">@ci.distancia</h6>

                    <!-- Itera para mostrar la calificación -->
                    <div class="text-center">
                        @for (int cal = 1; cal <= 5; cal++)
                        {

                            if (cal <= ci.calificacion)
                            {

                                <span class="fa fa-star checked"></span>

                            }
                            else
                            {
                                <span class="fa fa-star"></span>

                            }


                        }
                    </div>
                </div>
            </div>


        }


    </div>

    <div class="center">
        <a href="#" id="prev@(contador)">&lt;&lt; Prev </a>
        <a href="#" id="next@(contador)"> Next &gt;&gt; </a>
    </div>
    contador++;
}

<h2>O busca nuevos expertos</h2>
@using (Html.BeginForm())
{

    <div class="row">
        <div class="col-sm-3">
            <div class="row">
                <div class="col-sm-6 text-center" style="vertical-align:middle">
                    <label>Categoría</label>
                </div>
                <div class="col-sm-6">
                    @Html.DropDownList("cboCategoria", (SelectList)ViewBag.categorias, null, new { @class = "form-control" })
                </div>
            </div>
        </div>

        <div class="col-sm-3">
            <div class="row">
                <div class="col-sm-6 text-center" style="vertical-align:middle">
                    <label>Subcategoría</label>
                </div>
                <div class="col-sm-6">
                    @Html.DropDownList("cboSubcategoria", (SelectList)ViewBag.subcategorias, null, new { @class = "form-control" })
                </div>
            </div>
        </div>

        <div class="col-sm-3">
            <input type="submit" class="btn btn-primary" value="Buscar" />
        </div>
        <div class="col-sm-3">
            <label>Mapa</label>

            <label class="switch" style="float:right">
                <input type="checkbox" checked>
                <span class="slider round"></span>
            </label>
        </div>
    </div>
    
}

    <div>
        @foreach (var i in ViewBag.busqueda)
        {
            <div>
                @i.nombres
            </div>

        }
    </div>



    <script>
    $(document).ready(function () {

        $('.cycle-slideshow').css('width', '100%');

        $("#cboCategoria").change(function () {

            var url ="@Url.Action("ObtenerSubcategorias", "Alumno")";
            var valor = $("#cboCategoria").val();
            var data = { categoria: valor };

            $.ajax({
                type: "POST",
                url: url,
                data: data,
                dataType: "json",
                success: function (response) {

                    $("#cboSubcategoria").empty();

                    var lista = JSON.parse(response);

                    for (var i in lista) {

                        var descripcion = lista[i].descripcion;
                        var id = lista[i].id;

                        $("#cboSubcategoria").append("<option value'" + id + "'>" + descripcion + "</option>");

                    }



                  }



            });

        });



        // style = "white-space: nowrap; overflow: hidden; text-overflow: ellipsis; word-wrap: normal;"

    });

    </script>
